---
description: Disney+ Handler - Shadow DOM and Player Controls
globs:
  - "**/disney.js"
---

# Disney+ Handler Notes

## Shadow DOM Button Access

Disney+ player controls use Shadow DOM. Access buttons via:
```javascript
document.body.querySelector(selector)?.shadowRoot?.querySelector("info-tooltip button")
```

Available selectors: `toggle-play-pause`, `toggle-fullscreen`, `toggle-mute-button`, `quick-rewind`, `quick-fast-forward`, `restart-playback`.

## Player Element

- Main player element: `disney-web-player`
- Make player focusable with `tabindex="-1"`
- Remove outline from both `disney-web-player` and `video` elements after focusing

## Focus Management

- Focus target: `disney-web-player` element
- Use `document.hasFocus()` check before calling `focus()` to avoid focusing when browser window is inactive
- Attach keydown listener directly to player element as fallback

## Subtitle Selectors

Disney+ subtitle menu uses radio inputs with labels:

- **Subtitle picker container**: `#subtitleTrackPicker`
- **Off option**: `input#subtitleTrackPicker-off` (locale-dependent label, e.g., "Vypnuto")
- **Language labels**: `#subtitleTrackPicker label.picker-item`
- **Get input ID from label**: `label.getAttribute('for')` â†’ `#subtitleTrackPicker-{id}`

To check if subtitles are on: `!document.querySelector('#subtitleTrackPicker-off').checked`

To select a language: Click the corresponding radio input element.
